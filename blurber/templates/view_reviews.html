{% extends 'base.html' %}
{% load staticfiles %}

{% block page_title %}Sort reviews{% endblock %}

{% block content %}
	<div>
		<br />
		<strong>{{ song.title }} by {{ song.artist }}</strong> [<a href="{% url 'weekly_schedule' %}">Songlist</a>]
		<p>{{ review_count }} review(s)</p>
		{% if success %}
		<p><em>Sort order updated.</em></p>
		{% endif %}
	</div>
	<div>
		<table>
			<tr><td>Review</td><td>Order</td></tr>
		<form method="post" action="">
			{% csrf_token %}
			{{ formset.management_form }}
			{% for form in formset %}
				{{ form.id }}
				<tr>
					<td>
						<p>{{ form.instance.writer }}</p>
						{{ form.instance.blurb|safe }}
						<strong>[{{ form.instance.score }}]</strong>
					</td>
					<td>
					{{ form.sort_order }}
					</td>
					<td>
						<a href="{% url 'move_review_top' form.instance.id %}">Move to top</a><br />
						<a href="{% url 'move_review_up' form.instance.id %}">Move up</a><br />
						<a href="{% url 'move_review_down' form.instance.id %}">Move down</a><br />
						<a href="{% url 'move_review_bottom' form.instance.id %}">Move to bottom</a>
					</td>
					{% if form.sort_order.errors %}
					<td>
						<p class="error-text">{{ form.sort_order.errors }}</p>
					</td>
					{% endif %}
				</tr>
			{% endfor %}
			<tr><td colspan="2">
				<input type="submit" name="submit_and_return_to_songlist" value="Save and return to song list" />
				<input type="submit" name="submit" value="Save and stay on sorting page" />
			</td></tr>
		</form>
		</table>
		{% if formset.errors %}{{ formset.errors }}{% endif %}
	</div>
	<div>
		TODO: Get HTML.
	</div>
	<br />
{% endblock %}